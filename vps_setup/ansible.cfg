[defaults]
# ホストキー確認を無効化（bootstrap.sh 側で accept-new を使用するため）
host_key_checking = False

# 出力フォーマット（ansible-core 2.13+ 対応）
stdout_callback = ansible.builtin.default
result_format = yaml

# Python インタープリタの自動検出
interpreter_python = auto_silent

# roles のパス
roles_path = ./roles

[ssh_connection]
# pipelining は Ubuntu 24.04 + OpenSSH 9.x 環境で Connection reset by peer を引き起こすため無効化
pipelining = False

# transfer_method = piped: Python モジュールを SFTP/SCP ではなく SSH パイプ経由で転送
# 理由: systemd タイマーで apt-daily-upgrade が実行中の場合、大量メモリ消費（～1.4GB）により
#       SFTP/SCP サブシステム起動用のメモリが枯渇し両方失敗することがある。
#       piped は SSH 接続の stdin/stdout をそのまま使うため追加プロセス不要。
transfer_method = piped

# SSH 接続オプション
# ControlMaster は bootstrap.sh 側で管理するため ここでは無効化
ssh_args = -o StrictHostKeyChecking=accept-new -o ControlMaster=no
